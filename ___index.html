<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Dis gonna be a game waba laba dub dub</title>
    <script src="https://cdn.socket.io/socket.io-1.3.4.js"></script>
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <style type="text/css">
    </style>
</head>
<body>

	<span id="messageArea"></span>

    <div id="connect">
    	User name:<br>
		<input type="text" id="txtUser">
		<br>
		User password:<br>
		<input type="password" id="txtPassword"><br>
		<button type="button" id="btnConnect">Log In</button>
		<button type="button" id="btnRegister">Register</button>
    </div>
    <div id="register">
		New user name:<br>
		<input type="text" id="txtNewUser">
		<br>
		Password:<br>
		<input type="password" id="txtNewPassword"><br>
		Repeat password:<br>
		<input type="password" id="txtRepPassword"><br>
		<button type="button" id="btnSubmitRegister">Register</button>
		<button type="button" id="btnBackConnect">Back</button>
    </div>
    <div id="game">
    	game!!!
		<button type="button" id="btnFindGame">Find game!</button>
    </div>

    <div id="gameInstance">
    	herooo
    		<button type="button" id="btnEndGame">End game!</button>
	</div>

    <script>
        $(document).ready(function () {
   			$('#register').hide();
   			$('#game').hide();
   			$('#gameInstance').hide();

        	var socket = io('http://pc.enumm.me:10101');

			socket.on('hello', function (data) {
				$('#messageArea').text('Server says: ' + data.msg);
			});

        	//---------------------------------register---------------------
        	$('#btnSubmitRegister').click(function(){

				if($('#txtNewPassword').val() ==  $('#txtRepPassword').val()){
					socket.emit('user_register', {name: $('#txtNewUser').val(), pass: $('#txtNewPassword').val()});
				}else{
					$('#messageArea').text("Passwords doesn't match.");
				}
			});

			socket.on('user_register_responce', function (data) {
				$('#messageArea').text(data.message);	
			});

			//---------------------------------log-in-----------------------
			$('#btnConnect').click(function(){
    			socket.emit('user_login',  {name: $('#txtUser').val(), pass: $('#txtPassword').val()});
			});

			socket.on('user_login_responce', function (data) {
				if(data.success){
					socket.emit('user_authenticated',  {uuid: data.uuid});

					$('#messageArea').text('authenticated, uuid:' + data.message);
					$('#register').hide();
					$('#connect').hide();
					$('#game').show();
				}
				else{
					$('#messageArea').text(data.message);
				}
			});

			socket.on('notification', function (data) {
				$('#messageArea').text(data.message);
			});

			$('#btnFindGame').click(function(){
				socket.emit('find_game');
				$('#game').hide();
				$('#gameInstance').show();
			});

			$('#btnEndGame').click(function(){
				socket.emit('end_game');
				$('#game').show();
				$('#gameInstance').hide();
			});

			socket.on('game_ended', function (data) {
				$('#messageArea').text('Server says: ' + data.msg);
				$('#game').show();
				$('#gameInstance').hide();
			});

			$('#btnRegister').click(function(){
    			$('#connect').hide();
    			$('#register').show();
			});

			$('#btnBackConnect').click(function(){
    			$('#connect').show();
    			$('#register').hide();
			});
        });
    </script>
</body>
</html>
